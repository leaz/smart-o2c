function M = ascent_drag_mass_state_jacobian (x,u,t)

g = 0.0016; 
T = 4e-3;
rho0 = 0.1;
S = 1;
Cd = 1;
c = 1.5;

M = [0 1 0 0 0; 
    0 -0.5*rho0*exp(-x(3))*S*Cd*(x(2).^2/(x(2).^2+x(4).^2).^0.5+(x(2).^2+x(4).^2).^0.5)/(x(5)) 0.5*rho0*exp(-x(3))*S*Cd*(x(2).^2+x(4).^2).^(0.5)*x(2)/(x(5)) -0.5*rho0*exp(-x(3))*S*Cd*x(2)*x(4)/(x(2).^2+x(4).^2).^0.5/(x(5)) 0.5*rho0*exp(-x(3))*S*Cd*(x(2).^2+x(4).^2).^(0.5)*x(2)/x(5)^2; 
    0 0 0 1 0;
    0 -0.5*rho0*exp(-x(3))*S*Cd*x(2)*x(4)/(x(2).^2+x(4).^2).^0.5/(x(5)) 0.5*rho0*exp(-x(3))*S*Cd*(x(2).^2+x(4).^2).^(0.5)*x(4)/(x(5)) -0.5*rho0*exp(-x(3))*S*Cd*(x(4).^2/(x(2).^2+x(4).^2).^0.5+(x(2).^2+x(4).^2).^0.5)/(x(5)) 0.5*rho0*exp(-x(3))*S*Cd*(x(2).^2+x(4).^2).^(0.5)*x(4)/x(5)^2;
    0 0 0 0 0];

M(isnan(M)) = 0;

end